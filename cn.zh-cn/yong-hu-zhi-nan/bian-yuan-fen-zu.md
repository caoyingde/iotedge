# 边缘分组

边缘分组是一种类似文件夹的管理功能，您可以通过分组的方式管理边缘相关的网关、设备，同时也可以管理规则计算、函数计算和消息路由内容。通过部署分组，将添加在分组中的资源部署至网关中。

1. 创建边缘分组。 
   1. 在[IoT控制台](http://iot.console.aliyun.com/)，选择**边缘管理** &gt; **边缘分组**。系统显示边缘分组页面。 
   2. 单击**新增分组**。系统显示创建分组页面。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15390814396722_zh-CN.png) 
   3. 设置分组名称，用于后续的查询及识别分组。我们还为您提供了标签能力，通过标签您可以更加有效的去归类及识别分组。 
   4. 单击**确认**。 
   5. 在边缘分组页面，选择已创建的分组，单击右侧的**查看**，进入分组详情页面。 
2. 分配网关。 
   1. 在分组详情页面，选择网关，单击**分配网关**。 
   2. 在分配网关页面中，选择已创建的网关，单击网关右侧的**分配**。 后续部署及重置的指令都将发送至该网关，目前一个分组有且仅有一个网关。
   3. 单击**完成**。 
3. 分配驱动。 1. 在分组详情页面，选择设备驱动，单击**分配驱动**。 2. 在分配驱动页面中，选择已创建的驱动或者官方驱动，单击驱动名称右侧的**分配**。

   ```text
   **说明：** 

   -   若使用自定义驱动，需要根据[自定义驱动](cn.zh-CN/用户指南/驱动管理/自定义驱动.md#)创建驱动，并分配到边缘分组中。
   -   若使用官方驱动，需要根据[官方驱动](cn.zh-CN/用户指南/驱动管理/官方驱动.md#)中的驱动使用步骤，创建符合要求的产品和设备。
   ```

   1. 单击**完成**，您已成功为分组分配了设备驱动。 

4. 分配设备。 
   1. 在分组详情页面，选择设备，单击**分配设备**。 
   2. 在分配设备页面中，将之前创建的设备\(只支持高级版产品创建的设备\)分配至分组中，单击设备右侧的**分配**。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15390814396726_zh-CN.png) 所有被分配到分组中的设备列表才是最终网关被允许访问的范围。
   3. 在驱动配置的弹框中，需先选择驱动，选择[3](bian-yuan-fen-zu.md#step3)中已分配到边缘分组中的驱动后单击**确定**。 
   4. 单击**完成**，完成设备的分配。 
5. （可选）分配规则。 
   1. 在分组详情页面，选择规则计算，单击**分配规则**。 
   2. 在分配规则页面中，将之前创建的[规则计算](https://github.com/caoyingde/iotedge/tree/c697ce413860528d62c9113f91fb2ceb706e7d24/cn.zh-CN/用户指南/cn.zh-CN/用户指南/配置边缘计算节点/控制台创建网关.md)中的规则分配至分组中，单击设备右侧的**分配**。 这些规则将在部署时发送至网关上，并在网关上执行规则定义的逻辑。
   3. 单击**完成**，完成分配规则计算到分组中。 
6. （可选）分配函数。 
   1. 在分组详情页面，选择函数计算，单击**分配函数**。 
   2. 在分配函数页面中，将之前创建的[函数计算](https://github.com/caoyingde/iotedge/tree/c697ce413860528d62c9113f91fb2ceb706e7d24/cn.zh-CN/用户指南/cn.zh-CN/用户指南/函数计算/边缘计算中的函数计算.md)中的函数分配至分组中，单击**分配**。 这些规则将在部署时发送至网关上，并在网关本地运行。
7. （可选）添加角色。

   **说明：** 分组中的函数在边缘网关运行时，若要调用阿里云其他云资源（例如调用访问OSS的API），则需要为分组添加角色。

   1. 在分组详情页面，选择设置，单击**添加角色**。 
   2. 在添加角色页面中，选择已经存在的角色，授予分组操作对应云资源的能力。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/153908143912935_zh-CN.png) 
      * **角色**：选择已经存在的服务角色。该服务角色必须已经选择IoT物联网为授信服务。若无可选服务角色，请参考[角色](https://github.com/caoyingde/iotedge/tree/c697ce413860528d62c9113f91fb2ceb706e7d24/cn.zh-CN/用户指南/身份管理/角色.md)内容，创建所需的服务角色。
      * **系统模板授权**：权限根据已选的角色，自动选取。若需要编辑权限，请参考[授权](https://github.com/caoyingde/iotedge/tree/c697ce413860528d62c9113f91fb2ceb706e7d24/cn.zh-CN/用户指南/授权管理/授权.md)内容，编辑角色的授权权限。
   3. 单击**确定**，您已成功为分组添加了角色。 

8. （可选）添加消息路由。 
   1. 在分组详情页面，选择消息路由，单击**添加路由**。 
   2. 在添加消息路由页面中，配置参数，您可以通过[消息路由](https://github.com/caoyingde/iotedge/tree/c697ce413860528d62c9113f91fb2ceb706e7d24/cn.zh-CN/用户指南/cn.zh-CN/用户指南/消息路由.md)中查看具体配置方式。 
   3. 单击**确定**，您已成功为分组添加了消息路由。 
9. 部署分组。 1. 在分组详情页面，单击**部署分组**，将上述分组中添加的资源部署至网关中。

   ```text
   **说明：** 当您分组中的网关处于离线状态时，您的部署请求将被托管，直到网关上线后平台将主动通知网关进行资源部署操作。

   ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15390814396732_zh-CN.png) 
   ```

   1. 您可以通过单击**部署详情**，查看部署过程。 如果您对当前分组内的资源做了修改，可以单击**分组部署**再次进行部署。

10. （可选）重置分组。

    **说明：**

    * 由于该操作会将网关从工作状态切换为初始状态所以请谨慎操作。
    * 当您分组中的网关处于离线状态时，您的部署请求将被托管，直到网关上线后平台将主动通知网关进行资源重置操作。
    * 在分组详情页面，单击**重置**，重置已部署至网关中的资源（例如，将下发的规则计算、函数计算、消息路由等资源做清理）。 ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15108/15390814396733_zh-CN.png) 
    * 您可以单击**部署详情**，查看重置进展。 

